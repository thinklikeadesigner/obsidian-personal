/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Ze=Object.create;var et=Object.defineProperty;var je=Object.getOwnPropertyDescriptor;var Ve=Object.getOwnPropertyNames;var ze=Object.getPrototypeOf,He=Object.prototype.hasOwnProperty;var Ue=(n,t,e)=>t in n?et(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var qe=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),Je=(n,t)=>{for(var e in t)et(n,e,{get:t[e],enumerable:!0})},ne=(n,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Ve(t))!He.call(n,r)&&r!==e&&et(n,r,{get:()=>t[r],enumerable:!(s=je(t,r))||s.enumerable});return n};var se=(n,t,e)=>(e=n!=null?Ze(ze(n)):{},ne(t||!n||!n.__esModule?et(e,"default",{value:n,enumerable:!0}):e,n)),Xe=n=>ne(et({},"__esModule",{value:!0}),n);var C=(n,t,e)=>(Ue(n,typeof t!="symbol"?t+"":t,e),e);var Vt=qe(p=>{"use strict";Object.defineProperty(p,"__esModule",{value:!0});var b=require("obsidian"),Wt="YYYY-MM-DD",Ot="gggg-[W]ww",le="YYYY-MM",ce="YYYY-[Q]Q",ue="YYYY";function rt(n){let t=window.app.plugins.getPlugin("periodic-notes");return t&&t.settings?.[n]?.enabled}function it(){try{let{internalPlugins:n,plugins:t}=window.app;if(rt("daily")){let{format:i,folder:o,template:l}=t.getPlugin("periodic-notes")?.settings?.daily||{};return{format:i||Wt,folder:o?.trim()||"",template:l?.trim()||""}}let{folder:e,format:s,template:r}=n.getPluginById("daily-notes")?.instance?.options||{};return{format:s||Wt,folder:e?.trim()||"",template:r?.trim()||""}}catch(n){console.info("No custom daily note settings found!",n)}}function ot(){try{let n=window.app.plugins,t=n.getPlugin("calendar")?.options,e=n.getPlugin("periodic-notes")?.settings?.weekly;if(rt("weekly"))return{format:e.format||Ot,folder:e.folder?.trim()||"",template:e.template?.trim()||""};let s=t||{};return{format:s.weeklyNoteFormat||Ot,folder:s.weeklyNoteFolder?.trim()||"",template:s.weeklyNoteTemplate?.trim()||""}}catch(n){console.info("No custom weekly note settings found!",n)}}function at(){let n=window.app.plugins;try{let t=rt("monthly")&&n.getPlugin("periodic-notes")?.settings?.monthly||{};return{format:t.format||le,folder:t.folder?.trim()||"",template:t.template?.trim()||""}}catch(t){console.info("No custom monthly note settings found!",t)}}function lt(){let n=window.app.plugins;try{let t=rt("quarterly")&&n.getPlugin("periodic-notes")?.settings?.quarterly||{};return{format:t.format||ce,folder:t.folder?.trim()||"",template:t.template?.trim()||""}}catch(t){console.info("No custom quarterly note settings found!",t)}}function ct(){let n=window.app.plugins;try{let t=rt("yearly")&&n.getPlugin("periodic-notes")?.settings?.yearly||{};return{format:t.format||ue,folder:t.folder?.trim()||"",template:t.template?.trim()||""}}catch(t){console.info("No custom yearly note settings found!",t)}}function pe(...n){let t=[];for(let s=0,r=n.length;s<r;s++)t=t.concat(n[s].split("/"));let e=[];for(let s=0,r=t.length;s<r;s++){let i=t[s];!i||i==="."||e.push(i)}return t[0]===""&&e.unshift(""),e.join("/")}function Ke(n){let t=n.substring(n.lastIndexOf("/")+1);return t.lastIndexOf(".")!=-1&&(t=t.substring(0,t.lastIndexOf("."))),t}async function tn(n){let t=n.replace(/\\/g,"/").split("/");if(t.pop(),t.length){let e=pe(...t);window.app.vault.getAbstractFileByPath(e)||await window.app.vault.createFolder(e)}}async function ut(n,t){t.endsWith(".md")||(t+=".md");let e=b.normalizePath(pe(n,t));return await tn(e),e}async function q(n){let{metadataCache:t,vault:e}=window.app,s=b.normalizePath(n);if(s==="/")return Promise.resolve(["",null]);try{let r=t.getFirstLinkpathDest(s,""),i=await e.cachedRead(r),o=window.app.foldManager.load(r);return[i,o]}catch(r){return console.error(`Failed to read the daily note template '${s}'`,r),new b.Notice("Failed to read the daily note template"),["",null]}}function $(n,t="day"){let e=n.clone().startOf(t).format();return`${t}-${e}`}function de(n){return n.replace(/\[[^\]]*\]/g,"")}function en(n,t){if(t==="week"){let e=de(n);return/w{1,2}/i.test(e)&&(/M{1,4}/.test(e)||/D{1,4}/.test(e))}return!1}function J(n,t){return fe(n.basename,t)}function nn(n,t){return fe(Ke(n),t)}function fe(n,t){let s={day:it,week:ot,month:at,quarter:lt,year:ct}[t]().format.split("/").pop(),r=window.moment(n,s,!0);if(!r.isValid())return null;if(en(s,t)&&t==="week"){let i=de(s);if(/w{1,2}/i.test(i))return window.moment(n,s.replace(/M{1,4}/g,"").replace(/D{1,4}/g,""),!1)}return r}var Yt=class extends Error{};async function ge(n){let t=window.app,{vault:e}=t,s=window.moment,{template:r,format:i,folder:o}=it(),[l,c]=await q(r),a=n.format(i),f=await ut(o,a);try{let m=await e.create(f,l.replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,s().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a).replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(y,w,x,A,u,g)=>{let N=s(),v=n.clone().set({hour:N.get("hour"),minute:N.get("minute"),second:N.get("second")});return x&&v.add(parseInt(A,10),u),g?v.format(g.substring(1).trim()):v.format(i)}).replace(/{{\s*yesterday\s*}}/gi,n.clone().subtract(1,"day").format(i)).replace(/{{\s*tomorrow\s*}}/gi,n.clone().add(1,"d").format(i)));return t.foldManager.save(m,c),m}catch(m){console.error(`Failed to create file: '${f}'`,m),new b.Notice("Unable to create new file.")}}function sn(n,t){return t[$(n,"day")]??null}function rn(){let{vault:n}=window.app,{folder:t}=it(),e=n.getAbstractFileByPath(b.normalizePath(t));if(!e)throw new Yt("Failed to find daily notes folder");let s={};return b.Vault.recurseChildren(e,r=>{if(r instanceof b.TFile){let i=J(r,"day");if(i){let o=$(i,"day");s[o]=r}}}),s}var Qt=class extends Error{};function on(){let{moment:n}=window,t=n.localeData()._week.dow,e=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(;t;)e.push(e.shift()),t--;return e}function an(n){return on().indexOf(n.toLowerCase())}async function me(n){let{vault:t}=window.app,{template:e,format:s,folder:r}=ot(),[i,o]=await q(e),l=n.format(s),c=await ut(r,l);try{let a=await t.create(c,i.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,m,y,w,x,A)=>{let u=window.moment(),g=n.clone().set({hour:u.get("hour"),minute:u.get("minute"),second:u.get("second")});return y&&g.add(parseInt(w,10),x),A?g.format(A.substring(1).trim()):g.format(s)}).replace(/{{\s*title\s*}}/gi,l).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*(sunday|monday|tuesday|wednesday|thursday|friday|saturday)\s*:(.*?)}}/gi,(f,m,y)=>{let w=an(m);return n.weekday(w).format(y.trim())}));return window.app.foldManager.save(a,o),a}catch(a){console.error(`Failed to create file: '${c}'`,a),new b.Notice("Unable to create new file.")}}function ln(n,t){return t[$(n,"week")]??null}function cn(){let n={};if(!Ae())return n;let{vault:t}=window.app,{folder:e}=ot(),s=t.getAbstractFileByPath(b.normalizePath(e));if(!s)throw new Qt("Failed to find weekly notes folder");return b.Vault.recurseChildren(s,r=>{if(r instanceof b.TFile){let i=J(r,"week");if(i){let o=$(i,"week");n[o]=r}}}),n}var Gt=class extends Error{};async function he(n){let{vault:t}=window.app,{template:e,format:s,folder:r}=at(),[i,o]=await q(e),l=n.format(s),c=await ut(r,l);try{let a=await t.create(c,i.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,m,y,w,x,A)=>{let u=window.moment(),g=n.clone().set({hour:u.get("hour"),minute:u.get("minute"),second:u.get("second")});return y&&g.add(parseInt(w,10),x),A?g.format(A.substring(1).trim()):g.format(s)}).replace(/{{\s*date\s*}}/gi,l).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,l));return window.app.foldManager.save(a,o),a}catch(a){console.error(`Failed to create file: '${c}'`,a),new b.Notice("Unable to create new file.")}}function un(n,t){return t[$(n,"month")]??null}function pn(){let n={};if(!_e())return n;let{vault:t}=window.app,{folder:e}=at(),s=t.getAbstractFileByPath(b.normalizePath(e));if(!s)throw new Gt("Failed to find monthly notes folder");return b.Vault.recurseChildren(s,r=>{if(r instanceof b.TFile){let i=J(r,"month");if(i){let o=$(i,"month");n[o]=r}}}),n}var Zt=class extends Error{};async function dn(n){let{vault:t}=window.app,{template:e,format:s,folder:r}=lt(),[i,o]=await q(e),l=n.format(s),c=await ut(r,l);try{let a=await t.create(c,i.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,m,y,w,x,A)=>{let u=window.moment(),g=n.clone().set({hour:u.get("hour"),minute:u.get("minute"),second:u.get("second")});return y&&g.add(parseInt(w,10),x),A?g.format(A.substring(1).trim()):g.format(s)}).replace(/{{\s*date\s*}}/gi,l).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,l));return window.app.foldManager.save(a,o),a}catch(a){console.error(`Failed to create file: '${c}'`,a),new b.Notice("Unable to create new file.")}}function fn(n,t){return t[$(n,"quarter")]??null}function gn(){let n={};if(!ye())return n;let{vault:t}=window.app,{folder:e}=lt(),s=t.getAbstractFileByPath(b.normalizePath(e));if(!s)throw new Zt("Failed to find quarterly notes folder");return b.Vault.recurseChildren(s,r=>{if(r instanceof b.TFile){let i=J(r,"quarter");if(i){let o=$(i,"quarter");n[o]=r}}}),n}var jt=class extends Error{};async function mn(n){let{vault:t}=window.app,{template:e,format:s,folder:r}=ct(),[i,o]=await q(e),l=n.format(s),c=await ut(r,l);try{let a=await t.create(c,i.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(f,m,y,w,x,A)=>{let u=window.moment(),g=n.clone().set({hour:u.get("hour"),minute:u.get("minute"),second:u.get("second")});return y&&g.add(parseInt(w,10),x),A?g.format(A.substring(1).trim()):g.format(s)}).replace(/{{\s*date\s*}}/gi,l).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,l));return window.app.foldManager.save(a,o),a}catch(a){console.error(`Failed to create file: '${c}'`,a),new b.Notice("Unable to create new file.")}}function hn(n,t){return t[$(n,"year")]??null}function An(){let n={};if(!we())return n;let{vault:t}=window.app,{folder:e}=ct(),s=t.getAbstractFileByPath(b.normalizePath(e));if(!s)throw new jt("Failed to find yearly notes folder");return b.Vault.recurseChildren(s,r=>{if(r instanceof b.TFile){let i=J(r,"year");if(i){let o=$(i,"year");n[o]=r}}}),n}function _n(){let{app:n}=window,t=n.internalPlugins.plugins["daily-notes"];if(t&&t.enabled)return!0;let e=n.plugins.getPlugin("periodic-notes");return e&&e.settings?.daily?.enabled}function Ae(){let{app:n}=window;if(n.plugins.getPlugin("calendar"))return!0;let t=n.plugins.getPlugin("periodic-notes");return t&&t.settings?.weekly?.enabled}function _e(){let{app:n}=window,t=n.plugins.getPlugin("periodic-notes");return t&&t.settings?.monthly?.enabled}function ye(){let{app:n}=window,t=n.plugins.getPlugin("periodic-notes");return t&&t.settings?.quarterly?.enabled}function we(){let{app:n}=window,t=n.plugins.getPlugin("periodic-notes");return t&&t.settings?.yearly?.enabled}function yn(n){let t={day:it,week:ot,month:at,quarter:lt,year:ct}[n];return t()}function wn(n,t){return{day:ge,month:he,week:me}[n](t)}p.DEFAULT_DAILY_NOTE_FORMAT=Wt;p.DEFAULT_MONTHLY_NOTE_FORMAT=le;p.DEFAULT_QUARTERLY_NOTE_FORMAT=ce;p.DEFAULT_WEEKLY_NOTE_FORMAT=Ot;p.DEFAULT_YEARLY_NOTE_FORMAT=ue;p.appHasDailyNotesPluginLoaded=_n;p.appHasMonthlyNotesPluginLoaded=_e;p.appHasQuarterlyNotesPluginLoaded=ye;p.appHasWeeklyNotesPluginLoaded=Ae;p.appHasYearlyNotesPluginLoaded=we;p.createDailyNote=ge;p.createMonthlyNote=he;p.createPeriodicNote=wn;p.createQuarterlyNote=dn;p.createWeeklyNote=me;p.createYearlyNote=mn;p.getAllDailyNotes=rn;p.getAllMonthlyNotes=pn;p.getAllQuarterlyNotes=gn;p.getAllWeeklyNotes=cn;p.getAllYearlyNotes=An;p.getDailyNote=sn;p.getDailyNoteSettings=it;p.getDateFromFile=J;p.getDateFromPath=nn;p.getDateUID=$;p.getMonthlyNote=un;p.getMonthlyNoteSettings=at;p.getPeriodicNoteSettings=yn;p.getQuarterlyNote=fn;p.getQuarterlyNoteSettings=lt;p.getTemplateInfo=q;p.getWeeklyNote=ln;p.getWeeklyNoteSettings=ot;p.getYearlyNote=hn;p.getYearlyNoteSettings=ct});var jn={};Je(jn,{default:()=>Lt});module.exports=Xe(jn);var Qe=require("obsidian");var k=require("obsidian");var xt=class{constructor(){this.customFolder="Day Planners";this.mode=0;this.mermaid=!1;this.notesToDates=[];this.completePastItems=!0;this.circularProgress=!1;this.nowAndNextInStatusBar=!1;this.showTaskNotification=!1;this.timelineZoomLevel=4;this.timelineIcon="calendar-with-checkmark";this.plannerLabel="Day Planner";this.breakLabel="BREAK";this.endLabel="END";this.markCurrent=!1;this.correctLabels=!0;this.writer=void 0;this.preserveValues="-"}},V=class{constructor(t,e){this.notePath=t,this.date=e}},W=class{exists(t){return t&&this.active(t)!==void 0}active(t){let e=new Date().toDateString();return t&&t.filter(s=>s.date===e)[0]}},S=(s=>(s[s.File=0]="File",s[s.Command=1]="Command",s[s.Daily=2]="Daily",s))(S||{});var re="YYYYMMDD",ie=/(?<target>{{date:?(?<date>[^}]*)}})/g,oe="Day Planner-{{date}}.md",vt=`## Day Planner
- [ ] `,z="timeline";var ae=["any-key","audio-file","blocks","broken-link","bullet-list","calendar-with-checkmark","checkmark","create-new","cross","cross-in-box","crossed-star","dice","document","documents","dot-network","enter","expand-vertically","filled-pin","folder","gear","go-to-file","hashtag","help","horizontal-split","image-file","info","install","languages","left-arrow","left-arrow-with-tail","lines-of-text","link","logo-crystal","magnifying-glass","microphone","microphone-filled","open-vault","pane-layout","paper-plane","pdf-file","pencil","pin","popup-open","presentation","reset","right-arrow","right-arrow-with-tail","right-triangle","search","sheets-in-box","star","star-list","switch","three-horizontal-bars","trash","two-columns","up-and-down-arrows","uppercase-lowercase-a","vault","vertical-split","vertical-three-dots"];var Q=class{replace(t){let e=ie,s=t,r=[],i;for(;i=e.exec(s);)r.push(i);if(!r||r.length===0)return t;let o=new Date,l=r.map(a=>{let f=a.groups.date===""?re:a.groups.date;return[a.groups.target,this.getMoment(o,f)]}),c=s;return l.forEach(a=>{c=c.replace(a[0],a[1])}),c}getMoment(t,e){return window.moment,window.moment(t).format(e)}};var Et=class extends k.PluginSettingTab{constructor(e,s){super(e,s);this.momentDateRegex=new Q;this.plugin=s}display(){let{containerEl:e}=this;e.empty(),new k.Setting(e).setName("Day Planner mode").setDesc(this.modeDescriptionContent()).addDropdown(s=>s.addOption(S[0],"File mode").addOption(S[1],"Command mode").addOption(S[2],"Daily mode").setValue(S[this.plugin.settings.mode]||0 .toString()).onChange(r=>{this.plugin.settings.mode=S[r],this.plugin.saveData(this.plugin.settings)})),new k.Setting(e).setName("Complete past planner items").setDesc("The plugin will automatically mark checkboxes for tasks and breaks in the past as complete (x)").addToggle(s=>s.setValue(this.plugin.settings.completePastItems).onChange(r=>{this.plugin.settings.completePastItems=r,this.plugin.saveData(this.plugin.settings)})),new k.Setting(e).setName("Mark in progress planner item").setDesc("The plugin will automatically mark the textbox for the current item as in progress (/)").addToggle(s=>s.setValue(this.plugin.settings.markCurrent).onChange(r=>{this.plugin.settings.markCurrent=r,this.plugin.saveData(this.plugin.settings)})),new k.Setting(e).setName("Status bar - circular progress").setDesc("Display a circular progress bar in the status bar").addToggle(s=>s.setValue(this.plugin.settings.circularProgress).onChange(r=>{this.plugin.settings.circularProgress=r,this.plugin.saveData(this.plugin.settings)})),new k.Setting(e).setName("Status bar - now and next").setDesc("Display now and next tasks in the status bar").addToggle(s=>s.setValue(this.plugin.settings.nowAndNextInStatusBar).onChange(r=>{this.plugin.settings.nowAndNextInStatusBar=r,this.plugin.saveData(this.plugin.settings)})),new k.Setting(e).setName("Task notification").setDesc("Display a notification when a new task is started").addToggle(s=>s.setValue(this.plugin.settings.showTaskNotification).onChange(r=>{this.plugin.settings.showTaskNotification=r,this.plugin.saveData(this.plugin.settings)})),new k.Setting(e).setName("Timeline zoom level").setDesc("The zoom level to display the timeline. The higher the number, the more vertical space each task will take up.").addSlider(s=>s.setLimits(1,5,1).setValue(this.plugin.settings.timelineZoomLevel??4).setDynamicTooltip().onChange(r=>{this.plugin.settings.timelineZoomLevel=r,this.plugin.saveData(this.plugin.settings)})),new k.Setting(e).setName("Timeline icon").setDesc("The icon of the timeline pane. Reopen timeline pane or restart obsidian to see the change.").addDropdown(s=>(ae.forEach(r=>s.addOption(r,r)),s.setValue(this.plugin.settings.timelineIcon??"calendar-with-checkmark").onChange(r=>{this.plugin.settings.timelineIcon=r,this.plugin.saveData(this.plugin.settings)}))),new k.Setting(e).setName("Day Planner heading").setDesc("Use this heading text to mark the beginning of the Day Planner.").addText(s=>s.setValue(this.plugin.settings.plannerLabel??"Day Planner").onChange(r=>{r=r.trim(),r.length>0&&(this.plugin.settings.plannerLabel=r,this.plugin.saveData(this.plugin.settings))})),new k.Setting(e).setName("BREAK task label").setDesc("Use this label to mark break between tasks.").addText(s=>s.setValue(this.plugin.settings.breakLabel??"BREAK").onChange(r=>{this.plugin.settings.breakLabel=r,this.plugin.saveData(this.plugin.settings)})),new k.Setting(e).setName("END task label").setDesc("Use this label to mark the end of all tasks.").addText(s=>s.setValue(this.plugin.settings.endLabel??"END").onChange(r=>{this.plugin.settings.endLabel=r,this.plugin.saveData(this.plugin.settings)})),new k.Setting(e).setName("Consistent BREAK and END labels").setDesc("Replace BREAK and END task text in your planner with the configured label text (consistency)").addToggle(s=>s.setValue(this.plugin.settings.correctLabels).onChange(r=>{this.plugin.settings.correctLabels=r,this.plugin.saveData(this.plugin.settings)})),new k.Setting(e).setName("Preserve task values").setDesc("Preserve these values in the schedule, for example '-' for canceled, or '>' for rescheduled.").addText(s=>s.setValue(this.plugin.settings.preserveValues??"-").onChange(r=>{if(r.length>0)return[...new Set(r)].sort().join("").replace("x","");this.plugin.settings.preserveValues=r}))}modeDescriptionContent(){let e=document.createDocumentFragment();return e.appendText("Choose between 3 modes to use the Day Planner plugin:"),e.appendChild(document.createElement("br")),e.appendChild(document.createElement("strong")).appendText("File mode"),e.appendChild(document.createElement("br")),e.appendText("Plugin automatically generates day planner notes for each day within a Day Planners folder."),e.appendChild(document.createElement("br")),e.appendChild(document.createElement("strong")).appendText("Command mode"),e.appendChild(document.createElement("br")),e.appendText("Command used to insert a Day Planner for today within the current note."),e.appendChild(document.createElement("br")),e.appendChild(document.createElement("strong")).appendText("Daily mode"),e.appendChild(document.createElement("br")),e.appendText("Plugin automatically links to the current daily note. Daily notes plugin must be enabled."),e.appendChild(document.createElement("br")),this.addDocsLink(e),e}addDocsLink(e){let s=document.createElement("a");s.href="https://github.com/ebullient/obsidian-day-planner-og/blob/main/README.md",s.text="plugin README",s.target="_blank",e.appendChild(s),e.appendChild(document.createElement("br"))}};var nt=class{constructor(t,e,s,r,i,o){this.settings=t,this.statusBar=e,this.workspace=s,this.progress=r,this.plannerMD=i,this.file=o}initStatusBar(){if(this.statusBarAdded)return;let t=this.statusBar.createEl("div",{cls:"day-planner",title:"View the Day Planner",prepend:!0});this.setupCard(t),this.statusBarText=t.createEl("span",{cls:["status-bar-item-segment","day-planner-status-bar-text"]}),this.setupCircularProgressBar(t),this.setupHorizontalProgressBar(t),this.nextText=t.createEl("span",{cls:["status-bar-item-segment","day-planner-status-bar-text"]}),this.setupStatusBarEvents(t),this.statusBarAdded=!0}setupStatusBarEvents(t){t.onClickEvent(async e=>{try{let s=this.file.todayPlannerFilePath();this.workspace.openLinkText(s,"",!1)}catch(s){console.log(s)}}),t.on("mouseenter",".day-planner",()=>{this.show(this.card)}),t.on("mouseleave",".day-planner",()=>{this.hide(this.card)})}async refreshStatusBar(t){return!t.empty&&!t.invalid?(this.updateProgress(t.current,t.next),this.show(this.statusBar)):this.hide(this.statusBar),t}hide(t){t&&(t.style.display="none")}show(t){t&&(t.style.display="block")}hideProgress(){this.hide(this.statusBarProgress),this.hide(this.circle),this.hide(this.nextText)}updateProgress(t,e){if(!t||!e||t.isEnd){this.hideProgress(),this.statusBarText.innerText=this.settings.endLabel;return}let{percentageComplete:s,minsUntilNext:r}=this.progress.getProgress(t,e);this.settings.circularProgress?(this.hide(this.statusBarProgress),this.progressCircle(s,t)):(this.hide(this.circle),this.progressBar(s,t)),this.statusText(r,t,e,s)}progressBar(t,e){e.isBreak?this.statusBarCurrentProgress.addClass("green"):this.statusBarCurrentProgress.removeClass("green"),this.statusBarCurrentProgress.style.width=`${t}%`,this.show(this.statusBarProgress)}progressCircle(t,e){e.isBreak?this.circle.addClass("green"):this.circle.removeClass("green"),this.circle.setAttr("data-value",t.toFixed(0)),this.show(this.circle)}statusText(t,e,s,r){t=t==="0"?"1":t;let i=`${t} min${t==="1"?"":"s"}`;if(this.settings.nowAndNextInStatusBar)this.statusBarText.innerHTML=`<strong>Now</strong> ${e.rawTime} ${this.ellipsis(e.text,10)}`,this.nextText.innerHTML=`<strong>Next</strong> ${s.rawTime} ${this.ellipsis(s.text,10)}`,this.show(this.nextText);else{this.hide(this.nextText);let f=e.isBreak?`${this.settings.breakLabel} for ${i}`:`${i} left`;this.statusBarText.innerText=f}let o=`Current Task (${r.toFixed(0)}% complete)`,l=`${e.rawTime} ${e.text}`,c=`Next Task (in ${i})`,a=`${s.rawTime} ${s.text}`;this.cardCurrent.innerHTML=`<strong>${o}</strong><br> ${l}`,this.cardNext.innerHTML=`<strong>${c}</strong><br> ${a}`,this.taskNotification(e,l,c,a)}taskNotification(t,e,s,r){this.settings.showTaskNotification&&this.currentTime!==void 0&&this.currentTime!==t.time.toUTCString()&&new Notification(`Task started, ${e}`,{body:`${s}: ${r}`,requireInteraction:!0}),this.currentTime=t.time.toUTCString()}ellipsis(t,e){return t.length<=e?t:t.substring(0,e)+"..."}setupHorizontalProgressBar(t){this.statusBarProgress=t.createEl("div",{cls:["status-bar-item-segment","day-planner-progress-bar"]}),this.statusBarProgress.style.display="none",this.statusBarCurrentProgress=this.statusBarProgress.createEl("div",{cls:"day-planner-progress-value"})}setupCircularProgressBar(t){this.circle=t.createEl("div",{cls:["status-bar-item-segment","progress-pie day-planner"]})}setupCard(t){this.card=t.createEl("div",{cls:"day-planner-status-card"}),this.cardCurrent=this.card.createEl("span"),this.card.createEl("br"),this.card.createEl("br"),this.cardNext=this.card.createEl("span"),this.card.createEl("div",{cls:"arrow-down"})}};var H=window.moment,st=class{getProgress(t,e){try{let r=H(new Date),i=H(t.time),o=H(e.time),l=H.duration(o.diff(i)),c=H.duration(r.diff(i)),a=H.duration(o.diff(r)),f=c.asMinutes()/l.asMinutes()*100,m=a.asMinutes().toFixed(0);return{percentageComplete:f,minsUntilNext:m}}catch(s){console.log(s)}}progressMarkdown(t,e){try{let{percentageComplete:s}=this.getProgress(t,e),r=Math.floor(20*(s/100));return new Array(r).join("->")+new Array(20-r).join("_ ")}catch(s){console.log(s)}}};var Rt=require("obsidian");var L=class{constructor(t,e){this.iAmWriter=e,this.empty=t.length<1,this.invalid=!1,this.items=t,this.past=[]}addItem(t){this.items.push(t),this.empty=!1}calculate(t){try{if(this.items.length===0){this.empty=!0;return}this.items.forEach((e,s)=>{let r=this.items[s+1];if(e.time<t&&(e.isEnd||r&&t<r.time)?(this.current=e,e.isEnd&&(e.isPast=!0,this.past.push(e)),this.next=e.isEnd?null:r):e.time<t&&(e.isPast=!0,this.past.push(e)),r){let i=window.moment,o=i.duration(i(r.time).diff(i(e.time))).asMinutes();e.durationMins=o}})}catch(e){console.log(e)}}isCurrent(t){return t==this.current}},Mt=class{constructor(t,e,s,r,i,o,l,c,a){this.line=t,this.charIndex=e,this.status=s,this.isBreak=r,this.isEnd=i,this.time=o,this.rawTime=l,this.text=c,this.raw=a}},Pt=class{constructor(t){this.settings=t}getPlanItem(t,e,s,r,i,o,l,c,a){let f=this.getDisplayText(r,i,c);return new Mt(t,e,s,r,i,o,l,f,a)}getDisplayText(t,e,s){return t&&this.settings.correctLabels?this.settings.breakLabel:e&&this.settings.correctLabels?this.settings.endLabel:s}};var U=class{constructor(t,e,s,r,i){this.workspace=t,this.settings=e,this.file=s,this.parser=r,this.progress=i,this.noteForDateQuery=new W}async insertPlanner(){let t=this.file.todayPlannerFilePath(),s=this.workspace.getActiveViewOfType(Rt.MarkdownView).editor.getCursor().line;await this.file.processFile(t,r=>{let i=r.split(`
`);return[...i.slice(0,s),...vt.split(`
`),...i.slice(s)].join(`
`)})}async processDayPlanner(t){try{await this.file.prepareFile();let e=this.file.todayPlannerFilePath(),s=new L([],t),r=new Date;return await this.file.processFile(e,i=>this.parser.parseContent(i,s,r)),s}catch(e){console.log(e)}}checkIsDayPlannerEditing(){let t=this.workspace.getActiveViewOfType(Rt.MarkdownView);if(t==null)return;let e=t.getState(),s=this.file.todayPlannerFilePath();s&&e.file===s&&(this.dayPlannerLastEdit=new Date().getTime())}};var Ct=require("obsidian");var Dt=se(Vt()),pt=class{constructor(t,e){this.vault=t,this.settings=e,this.momentDateRegex=new Q,this.noteForDateQuery=new W}async hasTodayNote(){if(this.settings.mode==2&&(0,Dt.appHasDailyNotesPluginLoaded)()){let t=new Date,{folder:e,format:s}=(0,Dt.getDailyNoteSettings)(),r=this.momentDateRegex.getMoment(t,s)+".md",i=(0,Ct.normalizePath)(e+"/"+r);if(await this.vault.adapter.exists(i)){let o=new V(i,t.toDateString());return this.settings.notesToDates=[o],!0}return!1}return this.settings.mode===0||this.noteForDateQuery.exists(this.settings.notesToDates)}todayPlannerFilePath(){if(this.settings.mode===1||this.settings.mode===2)return this.noteForDateQuery.active(this.settings.notesToDates)?.notePath;let t=this.todayPlannerFileName();return`${this.settings.customFolder??"Day Planners"}/${t}`}todayPlannerFileName(){return this.momentDateRegex.replace(oe)}async prepareFile(){try{this.settings.mode===0&&(await this.createFolderIfNotExists(this.settings.customFolder),await this.createFileIfNotExists(this.todayPlannerFilePath()))}catch(t){console.log(t)}}async createFolderIfNotExists(t){try{let e=(0,Ct.normalizePath)(t);await this.vault.adapter.exists(e,!1)||await this.vault.createFolder(e)}catch(e){console.log(e)}}async createFileIfNotExists(t){try{let e=(0,Ct.normalizePath)(t);await this.vault.adapter.exists(e,!1)||await this.vault.create(e,vt)}catch(e){console.log(e)}}async processFile(t,e){try{return await this.vault.adapter.process(t,e)}catch(s){console.log(s)}}};var dt=class{constructor(t){this.updateSettings(t),this.PLAN_PARSER_REGEX=new RegExp("^(-?[\\s]*\\[?(?<completion>.)\\]\\s*?(?<hours>\\d{1,2}):(?<minutes>\\d{2})\\s(?<text>.*?))$","i")}updateSettings(t){this.settings=t,this.planItemFactory=new Pt(t),this.PLAN_START=`# ${this.settings.plannerLabel}`;let e=this.sanitize(t.breakLabel),s=this.sanitize(t.endLabel);this.PLAN_BREAK=new RegExp(`(?<=^|\\s)${e}(?=\\s|$)`),this.PLAN_END=new RegExp(`(?<=^|\\s)${s}(?=\\s|$)`)}sanitize(t){return t.replace(/\./g,"\\.").replace(/\*/g,"\\*").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\[/g,"\\[").replace(/\]/g,"\\]")}parseContent(t,e,s){let r=!1,i=t.split(`
`);return i.forEach((o,l)=>{if(o.length!=0)if(r){if(o=="---"){r=!1;return}let c=this.parseLine(l,o);c&&(e.addItem(c),r=!c.isEnd)}else o.trim().endsWith(this.PLAN_START)&&(r=!0)}),e.calculate(s),!e.empty&&e.iAmWriter&&e.items.forEach(o=>{let l=this.updateItemCompletion(o,e);i[o.line]=l}),i.join(`
`)}parseLine(t,e){try{let s=this.PLAN_PARSER_REGEX.exec(e);if(s){let r=s,i=r.groups.text,o=this.matches(i,this.PLAN_BREAK),l=this.matches(i,this.PLAN_END),c=new Date;return c.setHours(parseInt(r.groups.hours)),c.setMinutes(parseInt(r.groups.minutes)),c.setSeconds(0),this.planItemFactory.getPlanItem(t,r.index,r.groups.completion,o,l,c,`${r.groups.hours.padStart(2,"0")}:${r.groups.minutes}`,i,r[0])}}catch(s){console.log(s)}}updateItemCompletion(t,e){let s=t.status;return this.settings.completePastItems&&(this.settings.preserveValues.includes(s)||(t.isPast?s="x":this.settings.markCurrent&&e.isCurrent(t)?s="/":s=" ")),`- [${s}] ${t.rawTime} ${t.text}`}matches(t,e){return e.test(t.trim().toUpperCase())}};var Ye=require("obsidian");function F(){}function zt(n){return n()}function kt(){return Object.create(null)}function B(n){n.forEach(zt)}function ft(n){return typeof n=="function"}function It(n,t){return n!=n?t==t:n!==t||n&&typeof n=="object"||typeof n=="function"}function be(n){return Object.keys(n).length===0}var Ht=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;var Ft=class n{constructor(t){C(this,"_listeners","WeakMap"in Ht?new WeakMap:void 0);C(this,"_observer");C(this,"options");this.options=t}observe(t,e){return this._listeners.set(t,e),this._getObserver().observe(t,this.options),()=>{this._listeners.delete(t),this._observer.unobserve(t)}}_getObserver(){return this._observer??(this._observer=new ResizeObserver(t=>{for(let e of t)n.entries.set(e.target,e),this._listeners.get(e.target)?.(e)}))}};Ft.entries="WeakMap"in Ht?new WeakMap:void 0;var xe=!1;function ve(){xe=!0}function Ee(){xe=!1}function D(n,t){n.appendChild(t)}function Pe(n,t,e){let s=Ce(n);if(!s.getElementById(t)){let r=E("style");r.id=t,r.textContent=e,vn(s,r)}}function Ce(n){if(!n)return document;let t=n.getRootNode?n.getRootNode():n.ownerDocument;return t&&t.host?t:n.ownerDocument}function vn(n,t){return D(n.head||n,t),t.sheet}function T(n,t,e){n.insertBefore(t,e||null)}function I(n){n.parentNode&&n.parentNode.removeChild(n)}function De(n,t){for(let e=0;e<n.length;e+=1)n[e]&&n[e].d(t)}function E(n){return document.createElement(n)}function gt(n){return document.createTextNode(n)}function O(){return gt(" ")}function Ut(n,t,e,s){return n.addEventListener(t,e,s),()=>n.removeEventListener(t,e,s)}function _(n,t,e){e==null?n.removeAttribute(t):n.getAttribute(t)!==e&&n.setAttribute(t,e)}function ke(n){return Array.from(n.childNodes)}function Tt(n,t){t=""+t,n.data!==t&&(n.data=t)}function M(n,t,e,s){e==null?n.style.removeProperty(t):n.style.setProperty(t,e,s?"important":"")}function Ie(n){let t={};return n.childNodes.forEach(e=>{t[e.slot||"default"]=!0}),t}var Y;function R(n){Y=n}function qt(){if(!Y)throw new Error("Function called outside component initialization");return Y}function Jt(n){qt().$$.on_mount.push(n)}function G(n){qt().$$.on_destroy.push(n)}var Z=[];var Te=[],K=[],Ne=[],In=Promise.resolve(),Kt=!1;function $e(){Kt||(Kt=!0,In.then(Nt))}function mt(n){K.push(n)}var Xt=new Set,X=0;function Nt(){if(X!==0)return;let n=Y;do{try{for(;X<Z.length;){let t=Z[X];X++,R(t),Fn(t.$$)}}catch(t){throw Z.length=0,X=0,t}for(R(null),Z.length=0,X=0;Te.length;)Te.pop()();for(let t=0;t<K.length;t+=1){let e=K[t];Xt.has(e)||(Xt.add(e),e())}K.length=0}while(Z.length);for(;Ne.length;)Ne.pop()();Kt=!1,Xt.clear(),R(n)}function Fn(n){if(n.fragment!==null){n.update(),B(n.before_update);let t=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,t),n.after_update.forEach(mt)}}function Be(n){let t=[],e=[];K.forEach(s=>n.indexOf(s)===-1?t.push(s):e.push(s)),e.forEach(s=>s()),K=t}var Tn=new Set;function $t(n,t){n&&n.i&&(Tn.delete(n),n.i(t))}function ht(n){return n?.length!==void 0?n:Array.from(n)}var $n=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],Bn=new Set([...$n]);function Ln(n,t,e){let{fragment:s,after_update:r}=n.$$;s&&s.m(t,e),mt(()=>{let i=n.$$.on_mount.map(zt).filter(ft);n.$$.on_destroy?n.$$.on_destroy.push(...i):B(i),n.$$.on_mount=[]}),r.forEach(mt)}function Mn(n,t){let e=n.$$;e.fragment!==null&&(Be(e.after_update),B(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function Rn(n,t){n.$$.dirty[0]===-1&&(Z.push(n),$e(),n.$$.dirty.fill(0)),n.$$.dirty[t/31|0]|=1<<t%31}function Se(n,t,e,s,r,i,o=null,l=[-1]){let c=Y;R(n);let a=n.$$={fragment:null,ctx:[],props:i,update:F,not_equal:r,bound:kt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:kt(),dirty:l,skip_bound:!1,root:t.target||c.$$.root};o&&o(a.root);let f=!1;if(a.ctx=e?e(n,t.props||{},(m,y,...w)=>{let x=w.length?w[0]:y;return a.ctx&&r(a.ctx[m],a.ctx[m]=x)&&(!a.skip_bound&&a.bound[m]&&a.bound[m](x),f&&Rn(n,m)),y}):[],a.update(),f=!0,B(a.before_update),a.fragment=s?s(a.ctx):!1,t.target){if(t.hydrate){ve();let m=ke(t.target);a.fragment&&a.fragment.l(m),m.forEach(I)}else a.fragment&&a.fragment.c();t.intro&&$t(n.$$.fragment),Ln(n,t.target,t.anchor),Ee(),Nt()}R(c)}var Wn;typeof HTMLElement=="function"&&(Wn=class extends HTMLElement{constructor(t,e,s){super();C(this,"$$ctor");C(this,"$$s");C(this,"$$c");C(this,"$$cn",!1);C(this,"$$d",{});C(this,"$$r",!1);C(this,"$$p_d",{});C(this,"$$l",{});C(this,"$$l_u",new Map);this.$$ctor=t,this.$$s=e,s&&this.attachShadow({mode:"open"})}addEventListener(t,e,s){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){let r=this.$$c.$on(t,e);this.$$l_u.set(e,r)}super.addEventListener(t,e,s)}removeEventListener(t,e,s){if(super.removeEventListener(t,e,s),this.$$c){let r=this.$$l_u.get(e);r&&(r(),this.$$l_u.delete(e))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let t=function(i){return()=>{let o;return{c:function(){o=E("slot"),i!=="default"&&_(o,"name",i)},m:function(a,f){T(a,o,f)},d:function(a){a&&I(o)}}}};if(await Promise.resolve(),!this.$$cn||this.$$c)return;let e={},s=Ie(this);for(let i of this.$$s)i in s&&(e[i]=[t(i)]);for(let i of this.attributes){let o=this.$$g_p(i.name);o in this.$$d||(this.$$d[o]=te(o,i.value,this.$$p_d,"toProp"))}for(let i in this.$$p_d)!(i in this.$$d)&&this[i]!==void 0&&(this.$$d[i]=this[i],delete this[i]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:e,$$scope:{ctx:[]}}});let r=()=>{this.$$r=!0;for(let i in this.$$p_d)if(this.$$d[i]=this.$$c.$$.ctx[this.$$c.$$.props[i]],this.$$p_d[i].reflect){let o=te(i,this.$$d[i],this.$$p_d,"toAttribute");o==null?this.removeAttribute(this.$$p_d[i].attribute||i):this.setAttribute(this.$$p_d[i].attribute||i,o)}this.$$r=!1};this.$$c.$$.after_update.push(r),r();for(let i in this.$$l)for(let o of this.$$l[i]){let l=this.$$c.$on(i,o);this.$$l_u.set(o,l)}this.$$l={}}}attributeChangedCallback(t,e,s){this.$$r||(t=this.$$g_p(t),this.$$d[t]=te(t,s,this.$$p_d,"toProp"),this.$$c?.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{this.$$cn||(this.$$c.$destroy(),this.$$c=void 0)})}$$g_p(t){return Object.keys(this.$$p_d).find(e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t)||t}});function te(n,t,e,s){let r=e[n]?.type;if(t=r==="Boolean"&&typeof t!="boolean"?t!=null:t,!s||!e[n])return t;if(s==="toAttribute")switch(r){case"Object":case"Array":return t==null?null:JSON.stringify(t);case"Boolean":return t?"":null;case"Number":return t??null;default:return t}else switch(r){case"Object":case"Array":return t&&JSON.parse(t);case"Boolean":return t;case"Number":return t!=null?+t:t;default:return t}}var At=class{constructor(){C(this,"$$");C(this,"$$set")}$destroy(){Mn(this,1),this.$destroy=F}$on(t,e){if(!ft(e))return F;let s=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return s.push(e),()=>{let r=s.indexOf(e);r!==-1&&s.splice(r,1)}}$set(t){this.$$set&&!be(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}};var Le="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Le);var tt=[];function _t(n,t=F){let e,s=new Set;function r(l){if(It(n,l)&&(n=l,e)){let c=!tt.length;for(let a of s)a[1](),tt.push(a,n);if(c){for(let a=0;a<tt.length;a+=2)tt[a][0](tt[a+1]);tt.length=0}}}function i(l){r(l(n))}function o(l,c=F){let a=[l,c];return s.add(a),s.size===1&&(e=t(r,i)||F),l(n),()=>{s.delete(a),s.size===0&&e&&(e(),e=null)}}return{set:r,update:i,subscribe:o}}var yt=_t(new L([],!1)),wt=_t(0),Bt=_t(new Date),St=_t(4);function On(n){Pe(n,"svelte-9g5ftw",'#day-planner-timeline-container.svelte-9g5ftw.svelte-9g5ftw{position:relative;--skobeloff:#006466ff;--midnight-green-eagle-green:#065a60ff;--midnight-green-eagle-green-2:#0b525bff;--midnight-green-eagle-green-3:#144552ff;--charcoal:#1b3a4bff;--prussian-blue:#212f45ff;--space-cadet:#272640ff;--dark-purple:#312244ff;--russian-violet:#3e1f47ff;--russian-violet-2:#4d194dff}.aside.svelte-9g5ftw.svelte-9g5ftw{position:absolute;top:-1px;left:0;width:65px;height:100%;background-repeat:repeat-y;opacity:80%}.aside-x5.svelte-9g5ftw.svelte-9g5ftw{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAEsCAYAAADHIkNEAAAAAXNSR0IArs4c6QAAAFBlWElmTU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAABLAAAAAAuMW7GAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpMwidZAAAAsElEQVR4Ae3ZMQoAIAgFUL3/ocsO0GBLFE9wESJ8jj8jYlQrAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBbwWyNutGQuuNIkCAAAECBAgQIECAAAECBAgQIECAAAECBAgQeEbgJBLaLScq2smYEyBAgAABAgQIECBAgAABAgQIECBAgAABAgSuCpxEQqKfqyfzOQECBAgQIECAAAECBAgQIECAAAECBAgQIECgKzABwWUEBHBCyqYAAAAASUVORK5CYII=)}.aside-x4.svelte-9g5ftw.svelte-9g5ftw{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAADwCAYAAAAEqZSkAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAeGVYSWZNTQAqAAAACAAEARIAAwAAAAEAAQAAARoABQAAAAEAAAA+ARsABQAAAAEAAABGh2kABAAAAAEAAABOAAAAAAAAAEgAAAABAAAASAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAAA8AAAAABUK6+SAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjIyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMwMDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrL2/xqAAAA2klEQVR4Ae3bMQqEMBBA0QT2Bh7G+5d2e5G9wRZruliM6CCBsE8QQghxeOUHaynlvb/zPHUf9TXPuCYlQIAAAQIECBAgQIAAAQIECBAg8N8CLegtNwk+V863i7crB7sza7cev8y0ze/4MX2RAAECBAgQIECAAAECBAgQIECAAIEmkGmbkdyheWbaZnTxmOaZaZvRxJpnJGOfAAECBAgQIECAAAECBAgQIECAwEMCmbZ5aJjRHJm2OaZhnk189590DTPStE+AAAECBAgQIECAAAECBAgQIEBgVoEfgLcJ4JWKwMAAAAAASUVORK5CYII=)}.aside-x3.svelte-9g5ftw.svelte-9g5ftw{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAC0CAYAAACQYNzeAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAeGVYSWZNTQAqAAAACAAEARIAAwAAAAEAAQAAARoABQAAAAEAAAA+ARsABQAAAAEAAABGh2kABAAAAAEAAABOAAAAAAAAAEgAAAABAAAASAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAAAtAAAAAD5WFEbAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjIyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMwMDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrL2/xqAAAA6UlEQVRoBe3XQQrCQAwF0Bb0Hr2heB4v14MIOtmli8GmlFHhBQbimA7h7f48TdOjnf+pua16/Z91bUqAAAECBAgQIECAAAECHwQi58Wp1KsyfPpsbLsUX133zF/a0G3PYJq5p358GxSxdaWelWGzBAgQIECAAAECBAgQIDBUIHJenDNqTHiPbZcz1m1vrPmdIyE9f5/7MeE9KKohPW+Ze+E9a+gJECBAgAABAgQIECDwHYHIeXEqNSaM9zaKbZfen537tXO/uT4S0seE8c2a6UdQVEO6MJ4AtQQIECBAgAABAgQIECDwqwJv9lMMWDcoNMAAAAAASUVORK5CYII=)}.aside-x2.svelte-9g5ftw.svelte-9g5ftw{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAB4CAYAAAD2SgIRAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAeGVYSWZNTQAqAAAACAAEARIAAwAAAAEAAQAAARoABQAAAAEAAAA+ARsABQAAAAEAAABGh2kABAAAAAEAAABOAAAAAAAAAEgAAAABAAAASAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAAAeAAAAADVvVTBAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjIyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMwMDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrL2/xqAAAAt0lEQVRoBe3YMQqAMAyF4VYUD+Ii7p7JK7t4EkVsnOoSEtql+AuC2GdIPxxCYwhhS3c7V0ytju20S6cIIIAAAggg8EcBGVh658YvZ75uXDqenSV3S14YFkswy5gKZ3keEUAAAQQQQACBnwnI7NZV2vNdqY5eRjqe9Ih59ciTMm2u+YuC50/hgjr6p0Ix6BHz6mlOEkQAAQQQQAABBBwCMrBwtvmCcbbp+G+IIoAAAggggAACCDgFHqn/Cpqy3VM1AAAAAElFTkSuQmCC)}.aside-x1.svelte-9g5ftw.svelte-9g5ftw{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAA8CAYAAABig0prAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAeGVYSWZNTQAqAAAACAAEARIAAwAAAAEAAQAAARoABQAAAAEAAAA+ARsABQAAAAEAAABGh2kABAAAAAEAAABOAAAAAAAAAEgAAAABAAAASAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFqADAAQAAAABAAAAPAAAAAB4zqpIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACMWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8ZXhpZjpDb2xvclNwYWNlPjE8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjIyPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMwMDwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgrL2/xqAAAArElEQVRYCe2VSwqAMAxEW3WjK3eCHsT7H0bBQ/jp7LqokIQirUyhUMIkJA8y9c65Ndx6jg+tdvW0y05J4CcEsHmtcpZTqc8rR8eLsuQm0cOAeomwGA1Q4GrOrRFTSwIkkCCArWsScUvosiSpc9DxrM5KJ+xxGLY5xIHi3xbbfBuKdvpGhnESqJ8AvGJSjnFI9LDNUSKMNKLCkT7v0/LnffO35Z2T1UiABAol8ACZ6QleECm8BQAAAABJRU5ErkJggg==)}.aside__line.svelte-9g5ftw.svelte-9g5ftw{position:absolute;left:65px;transform:translateX(-50%);width:4px;height:100%;background:var(--text-accent)}.filled.svelte-9g5ftw.svelte-9g5ftw{transform-origin:top center;z-index:1;animation:scaleDown 1s ease-in-out;animation-fill-mode:forwards}.filled__line__completed.svelte-9g5ftw.svelte-9g5ftw{position:absolute;top:0;left:0;width:100%}.events.svelte-9g5ftw.svelte-9g5ftw{position:relative;padding-bottom:50px}.event_item.svelte-9g5ftw.svelte-9g5ftw{border-bottom:2px solid var(--background-primary);margin:0;cursor:pointer;padding:5px 10px 10px 0;width:100%;overflow:hidden}.event_item.short.svelte-9g5ftw.svelte-9g5ftw{padding:0}.event_item.svelte-9g5ftw.svelte-9g5ftw:hover{background-color:var(--interactive-accent-hover);box-shadow:0px 0px 52px -18px rgba(0, 0, 0, 0.75)}.event_item_color1.svelte-9g5ftw.svelte-9g5ftw{background-color:var(--skobeloff)}.event_item_color2.svelte-9g5ftw.svelte-9g5ftw{background-color:var(--midnight-green-eagle-green)}.event_item_color3.svelte-9g5ftw.svelte-9g5ftw{background-color:var(--midnight-green-eagle-green-2)}.event_item_color4.svelte-9g5ftw.svelte-9g5ftw{background-color:var(--midnight-green-eagle-green-3)}.event_item_color5.svelte-9g5ftw.svelte-9g5ftw{background-color:var(--charcoal)}.event_item_color6.svelte-9g5ftw.svelte-9g5ftw{background-color:var(--prussian-blue)}.event_item_color7.svelte-9g5ftw.svelte-9g5ftw{background-color:var(--space-cadet)}.event_item_color8.svelte-9g5ftw.svelte-9g5ftw{background-color:var(--dark-purple)}.event_item_color9.svelte-9g5ftw.svelte-9g5ftw{background-color:var(--russian-violet)}.event_item_color10.svelte-9g5ftw.svelte-9g5ftw{background-color:var(--russian-violet-2)}.event_item_contents.svelte-9g5ftw.svelte-9g5ftw{padding-left:58px}.ei_Copy.svelte-9g5ftw.svelte-9g5ftw,.ei_Title.svelte-9g5ftw.svelte-9g5ftw{color:var(--text-on-accent)}.ei_Dot.svelte-9g5ftw.svelte-9g5ftw,.ei_Title.svelte-9g5ftw.svelte-9g5ftw{display:inline-block}.ei_Dot.svelte-9g5ftw.svelte-9g5ftw{position:absolute;border-radius:50%;width:14px;height:14px;margin-top:5px;background-color:var(--text-accent);box-shadow:0px 0px 52px -18px rgba(0, 0, 0, 0.75);z-index:2}.dot_active.svelte-9g5ftw.svelte-9g5ftw{background-color:var(--text-error-hover)}.ei_Title.svelte-9g5ftw.svelte-9g5ftw{margin-left:26px}.ei_Copy.svelte-9g5ftw.svelte-9g5ftw{font-size:15px;display:inline-block;margin-left:28px}.header_title.svelte-9g5ftw.svelte-9g5ftw,.ei_Title.svelte-9g5ftw.svelte-9g5ftw,.ce_title.svelte-9g5ftw.svelte-9g5ftw{color:#fff}#now-line.svelte-9g5ftw.svelte-9g5ftw{height:4px;background-color:darkred;opacity:80%;position:absolute;z-index:3;width:100%}#now-line.svelte-9g5ftw .timeline-time.svelte-9g5ftw{position:relative;left:5px;top:0;background-color:darkred;color:#fff;padding:0 4px 2px 4px;border-radius:0 0 4px 4px;text-align:center}#scroll-controls.svelte-9g5ftw.svelte-9g5ftw{background-color:var(--background-secondary);position:sticky;bottom:0;width:100%;z-index:4;padding:8px 15px;text-align:center;height:45px}#scroll-controls.svelte-9g5ftw label.svelte-9g5ftw{display:block;float:left;margin:2px}#scroll-controls.svelte-9g5ftw .toggle.svelte-9g5ftw{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:50px;height:20px;display:block;float:left;position:relative;margin-top:5px;border-radius:50px;overflow:hidden;outline:none;border:none;cursor:pointer;background-color:var(--background-secondary-alt);transition:background-color ease 0.3s}#scroll-controls.svelte-9g5ftw .toggle.svelte-9g5ftw:before{content:"on    ";display:block;position:absolute;z-index:2;width:17px;height:17px;background:#fff;left:2px;top:1px;border-radius:50%;font:9px/18px Helvetica;text-transform:uppercase;font-weight:bold;text-indent:-24px;word-spacing:30px;color:#fff;text-shadow:-1px -1px rgba(0,0,0,0.15);white-space:nowrap;box-shadow:0 1px 2px rgba(0,0,0,0.2);transition:all cubic-bezier(0.3, 1.5, 0.7, 1) 0.3s}#scroll-controls.svelte-9g5ftw .toggle.svelte-9g5ftw:checked{background-color:var(--interactive-accent)}#scroll-controls.svelte-9g5ftw .toggle.svelte-9g5ftw:checked:before{left:31px}#scroll-controls.svelte-9g5ftw input[type=checkbox].svelte-9g5ftw:checked:after{background-color:transparent}.empty-timeline.svelte-9g5ftw.svelte-9g5ftw{text-align:center;vertical-align:middle;margin-top:50%}')}function Me(n,t,e){let s=n.slice();return s[19]=t[e],s[21]=e,s}function Yn(n){let t;return{c(){t=E("div"),t.textContent="No Planner Data",_(t,"class","empty-timeline svelte-9g5ftw")},m(e,s){T(e,t,s)},p:F,d(e){e&&I(t)}}}function Qn(n){let t,e,s,r,i,o,l,c,a=n[6](n[4]).format("HH:mm")+"",f,m,y,w,x,A,u,g,N=ht(n[0].items),v=[];for(let h=0;h<N.length;h+=1)v[h]=Re(Me(n,N,h));return{c(){t=E("div"),e=E("div"),e.innerHTML=`<div class="filled__line__completed svelte-9g5ftw" style="height: ${wt}px;"></div>`,r=O(),i=E("div");for(let h=0;h<v.length;h+=1)v[h].c();o=O(),l=E("div"),c=E("span"),f=gt(a),m=O(),y=E("div"),w=E("label"),w.textContent="Track time",x=O(),A=E("input"),_(e,"class","aside__line filled__line svelte-9g5ftw"),_(t,"class",s="aside aside-x"+n[1]+" filled svelte-9g5ftw"),M(t,"top",n[3]+"px"),_(i,"class","events svelte-9g5ftw"),_(c,"class","timeline-time svelte-9g5ftw"),_(l,"id","now-line"),M(l,"top",n[2]+"px"),M(l,"display",n[0].current&&!n[0].current.isEnd?"block":"none"),_(l,"class","svelte-9g5ftw"),_(w,"for","auto-scroll"),_(w,"class","svelte-9g5ftw"),_(A,"id","auto-scroll"),_(A,"type","checkbox"),_(A,"class","toggle svelte-9g5ftw"),_(y,"id","scroll-controls"),_(y,"class","svelte-9g5ftw")},m(h,P){T(h,t,P),D(t,e),T(h,r,P),T(h,i,P);for(let d=0;d<v.length;d+=1)v[d]&&v[d].m(i,null);T(h,o,P),T(h,l,P),D(l,c),D(c,f),T(h,m,P),T(h,y,P),D(y,w),D(y,x),D(y,A),A.checked=n[5],u||(g=Ut(A,"change",n[9]),u=!0)},p(h,P){if(P&2&&s!==(s="aside aside-x"+h[1]+" filled svelte-9g5ftw")&&_(t,"class",s),P&8&&M(t,"top",h[3]+"px"),P&131){N=ht(h[0].items);let d;for(d=0;d<N.length;d+=1){let j=Me(h,N,d);v[d]?v[d].p(j,P):(v[d]=Re(j),v[d].c(),v[d].m(i,null))}for(;d<v.length;d+=1)v[d].d(1);v.length=N.length}P&16&&a!==(a=h[6](h[4]).format("HH:mm")+"")&&Tt(f,a),P&4&&M(l,"top",h[2]+"px"),P&1&&M(l,"display",h[0].current&&!h[0].current.isEnd?"block":"none"),P&32&&(A.checked=h[5])},d(h){h&&(I(t),I(r),I(i),I(o),I(l),I(m),I(y)),De(v,h),u=!1,g()}}}function Re(n){let t,e,s,r,i,o,l=n[19].rawTime+"",c,a,f,m=(n[19].text??"")+"",y,w,x,A;return{c(){t=E("div"),e=E("div"),s=E("div"),i=O(),o=E("div"),c=gt(l),a=O(),f=E("div"),y=gt(m),w=O(),_(s,"class",r="ei_Dot "+(n[19]===n[0].current?"dot_active":"")+" svelte-9g5ftw"),_(o,"class","ei_Title svelte-9g5ftw"),_(f,"class","ei_Copy svelte-9g5ftw"),_(e,"class","event_item_contents svelte-9g5ftw"),_(t,"class",x="event_item event_item_color"+(n[21]%10+1)+" "+n[7](n[19])+" svelte-9g5ftw"),M(t,"height",n[19].durationMins*n[1]+"px"),_(t,"data-title",A=n[19].rawTime)},m(u,g){T(u,t,g),D(t,e),D(e,s),D(e,i),D(e,o),D(o,c),D(e,a),D(e,f),D(f,y),D(t,w)},p(u,g){g&1&&r!==(r="ei_Dot "+(u[19]===u[0].current?"dot_active":"")+" svelte-9g5ftw")&&_(s,"class",r),g&1&&l!==(l=u[19].rawTime+"")&&Tt(c,l),g&1&&m!==(m=(u[19].text??"")+"")&&Tt(y,m),g&1&&x!==(x="event_item event_item_color"+(u[21]%10+1)+" "+u[7](u[19])+" svelte-9g5ftw")&&_(t,"class",x),g&3&&M(t,"height",u[19].durationMins*u[1]+"px"),g&1&&A!==(A=u[19].rawTime)&&_(t,"data-title",A)},d(u){u&&I(t)}}}function Gn(n){let t;function e(i,o){return i[0].items.length>0?Qn:Yn}let s=e(n,-1),r=s(n);return{c(){t=E("div"),r.c(),_(t,"id","day-planner-timeline-container"),_(t,"class","svelte-9g5ftw")},m(i,o){T(i,t,o),r.m(t,null)},p(i,[o]){s===(s=e(i,o))&&r?r.p(i,o):(r.d(1),r=s(i),r&&(r.c(),r.m(t,null)))},i:F,o:F,d(i){i&&I(t),r.d()}}}function Zn(n,t,e){let s=window.moment,{summary:r}=t,{rootEl:i}=t,o,l,c,a,f=!0,m=yt.subscribe(d=>{e(0,r=d),v()}),y=wt.subscribe(d=>{e(2,l=d)}),w=Bt.subscribe(d=>{e(4,a=d),N(l-150),o||e(1,o=4)}),x=St.subscribe(d=>{e(1,o=d)});G(m),G(y),G(w),G(x),G(u),Jt(()=>{A()});function A(){i.addEventListener("scroll",g)}function u(){i.removeEventListener("scroll",g)}function g(d){e(5,f=!1)}function N(d){var j;f&&!(!((j=r.current)===null||j===void 0)&&j.isEnd)&&(u(),i.scrollTo({left:0,top:d,behavior:"smooth"}),setTimeout(A,1e3))}function v(){e(3,c=r.empty?0:r.items.first().time.getMinutes()*o*-1-1)}function h(d){return classes=[],d.durationMins<75/o&&classes.push("short"),d.isPast&&classes.push("past"),d.isBreak&&classes.push("break"),classes.join(" ")}function P(){f=this.checked,e(5,f)}return n.$$set=d=>{"summary"in d&&e(0,r=d.summary),"rootEl"in d&&e(8,i=d.rootEl)},[r,o,l,c,a,f,s,h,i,P]}var ee=class extends At{constructor(t){super(),Se(this,t,Zn,Gn,It,{summary:0,rootEl:8},On)}},We=ee;var Oe=window.moment,bt=class extends Ye.ItemView{constructor(t,e){super(t),this.settings=e}getViewType(){return z}getDisplayText(){return"Day Planner Timeline"}getIcon(){return this.settings.timelineIcon}update(t){yt.update(r=>r=t);let e=new Date;Bt.update(r=>r=e);let s=t.empty?0:this.positionFromTime(e)-this.positionFromTime(t.items.first().time);wt.update(r=>r=s),St.update(r=>r=this.settings.timelineZoomLevel)}positionFromTime(t){return Oe.duration(Oe(t).format("HH:mm")).asMinutes()*this.settings.timelineZoomLevel}async onOpen(){this.timeline=new We({target:this.contentEl,props:{planSummary:yt,rootEl:this.containerEl.children[1]}})}};var Ge=se(Vt()),Lt=class extends Qe.Plugin{constructor(){super(...arguments);this.codeMirror=e=>{this.file.hasTodayNote()&&this.plannerMD.checkIsDayPlannerEditing()}}get syncPlugin(){return this.app.internalPlugins.getPluginById("sync")}async onload(){console.log("Loading Day Planner plugin v"+this.manifest.version),this.vault=this.app.vault,this.settings=Object.assign(new xt,await this.loadData()),this.notesForDatesQuery=new W,this.file=new pt(this.vault,this.settings);let e=this.syncPlugin?.instance!=null;this.device=e?this.syncPlugin.instance.deviceName.length>0?this.syncPlugin.instance.deviceName:this.syncPlugin.instance.getDefaultDeviceName():"Unknown",console.debug("DPOG: Device/Writer:",this.settings.mode,this.device,this.settings.writer,this.isWriter());let s=new st;this.parser=new dt(this.settings),this.plannerMD=new U(this.app.workspace,this.settings,this.file,this.parser,s),this.statusBar=new nt(this.settings,this.addStatusBarItem(),this.app.workspace,s,new U(this.app.workspace,this.settings,this.file,this.parser,s),this.file),this.statusBar.initStatusBar(),this.registerEvent(this.app.vault.on("modify",this.codeMirror,"")),this.addCommand({id:"app:add-to-note",name:"Add a Day Planner template for today to the current note",callback:()=>this.modeGuard(async()=>await this.insertDayPlannerIntoCurrentNote(!0)),hotkeys:[]}),this.addCommand({id:"app:link-to-note",name:"Link today's Day Planner to the current note",callback:()=>this.modeGuard(async()=>await this.insertDayPlannerIntoCurrentNote(!1)),hotkeys:[]}),this.addCommand({id:"app:unlink-from-note",name:"Unlink today's Day Planner from its note",callback:()=>this.modeGuard(async()=>await this.unlinkDayPlanner()),hotkeys:[]}),this.addCommand({id:"app:show-timeline",name:"Show the Day Planner Timeline",callback:()=>this.initLeaf(),hotkeys:[]}),this.addCommand({id:"app:show-today-note",name:"Show today's Day Planner",callback:()=>this.app.workspace.openLinkText(this.file.todayPlannerFilePath(),"",!0),hotkeys:[]}),this.addCommand({id:"app:set-as-writer",name:`Set current device '${this.device}' as writer`,callback:async()=>{this.settings.writer=this.device,this.save()},hotkeys:[]}),this.registerView(z,r=>this.timelineView=new bt(r,this.settings)),this.addSettingTab(new Et(this.app,this)),this.setTicker()}async onunload(){this.interval&&(console.debug("DPOG: Clearing ticker"),window.clearInterval(this.interval))}async handleConfigFileChange(){await super.handleConfigFileChange(),this.settings=Object.assign(this.settings,await this.loadData()),this.parser.updateSettings(this.settings);let e=await this.file.hasTodayNote();console.log("DPOG: update Device/Writer:",this.settings.mode,this.device,this.settings.writer,this.isWriter(),e)}isWriter(){return this.device==="Unknown"||!this.settings.writer||this.settings.writer===this.device}setTicker(){this.interval&&(console.debug("DPOG: Clearing ticker"),window.clearInterval(this.interval),this.interval=void 0),console.log("DPOG: set Ticker with Device/Writer:",this.device,this.settings.writer,this.isWriter()),this.interval=window.setInterval(()=>this.tick(),2e3)}async tick(){try{if(await this.file.hasTodayNote()){let e=await this.plannerMD.processDayPlanner(this.isWriter());await this.statusBar.refreshStatusBar(e),this.timelineView&&this.timelineView.update(e)}else if(this.settings.mode==2&&(0,Ge.appHasDailyNotesPluginLoaded)()){let e=new L([],this.isWriter());await this.statusBar.refreshStatusBar(e),this.timelineView&&this.timelineView.update(e)}}catch(e){console.log(e)}}initLeaf(){this.app.workspace.getLeavesOfType(z).length>0||this.app.workspace.getRightLeaf(!0).setViewState({type:z})}modeGuard(e){if(this.settings.mode!==1){new Notification("Day Planner plugin in File mode",{silent:!0,body:"Switch to Command mode in settings to use this command"});return}else e()}async insertDayPlannerIntoCurrentNote(e){try{let r=this.app.workspace.activeLeaf.view.getState().file,i=this.notesForDatesQuery.exists(this.settings.notesToDates),o=this.notesForDatesQuery.active(this.settings.notesToDates)?.notePath;if(this.settings.notesToDates=this.settings.notesToDates||[],i&&o!==r){new Notification("Day Planner exists",{silent:!0,body:`A Day Planner for today already exists in ${o}`});return}else i?this.settings.notesToDates||(this.settings.notesToDates=[]):this.settings.notesToDates=[new V(r,new Date().toDateString())];await this.save(),e&&this.plannerMD.insertPlanner()}catch(s){console.error(s)}}async unlinkDayPlanner(){try{let e=this.notesForDatesQuery.active(this.settings.notesToDates);if(!e){new Notification("No Day Planner found",{silent:!0,body:"No Day Planner found for today"});return}this.settings.notesToDates=this.settings.notesToDates||[],this.settings.notesToDates.remove(e),await this.save(),this.statusBar.hide(this.statusBar.statusBar),this.timelineView&&this.timelineView.update(new L([],this.isWriter())),new Notification("Day Planner reset",{silent:!0,body:`The Day Planner for today has been dissociated from ${e.notePath} and can be added to another note`})}catch(e){console.error(e)}}async save(){await this.saveData(this.settings)}};
